---
title: "Lifestyle Factors & Student Performance Analysis"
author: "Elham Morshedi"
output:
  html_document:
    fig_width: 8
    code_folding: hide
    highlight: tango
    toc: true
    toc_float:
      collapsed: true
    theme: readable
---

<style>
body {
  font-size: 18px;
  line-height: 1.6;
}
h1, h2, h3, h4 {
  color: #2c3e50;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width=8, fig.height=6,
                      echo=FALSE, warning=FALSE, message=FALSE)
```

# Project Overview

This project analyzes the relationship between lifestyle factors and academic performance among university students. The dataset contains information about study habits, sleep patterns, physical activity, social time, stress levels, and academic grades for 2,000 students. The analysis aims to identify key factors that influence student success and understand how different lifestyle choices correlate with academic performance.

**Data Source:** Student Lifestyle Dataset from Kaggle  
**Dataset Size:** 2,000 students with 7 variables  
**Analysis Focus:** Relationship between lifestyle factors and GPA

```{r libraries}
# Load required libraries
library(plotly)
library(dplyr)
library(tidyverse)
library(sampling)
library(reshape2)
library(knitr)
```

# Data Import and Preprocessing

The dataset was successfully imported with no missing values detected. All variables are properly formatted and ready for analysis.

```{r data-import, echo=TRUE}
# Import the lifestyle dataset
data <- read.csv("student_lifestyle_dataset.csv")

# Basic dataset information
cat("Dataset dimensions:", dim(data), "\n")
cat("Number of students:", nrow(data), "\n")
cat("Number of variables:", ncol(data), "\n")

# Check for missing values
missing_values <- colSums(is.na(data))
cat("Missing values per column:\n")
print(missing_values)

# Display structure
str(data)
```

**Preprocessing Notes:** The dataset required no additional preprocessing as it was clean with no missing values. All variables were properly coded with appropriate data types.

# Single Variable Analysis

## Categorical Analysis: Stress Level Distribution

The stress level distribution reveals important patterns in the student population.

```{r stress-analysis, echo=TRUE}
# Stress Level Distribution
stress_table <- table(data$Stress_Level)
stress_prop <- round(prop.table(stress_table) * 100, 1)

print("Stress Level Counts:")
print(stress_table)
print("Stress Level Percentages:")
print(stress_prop)

# Interactive stress level plot
stress_df <- data.frame(
  Stress_Level = names(stress_table), 
  Count = as.vector(stress_table)
)

x_axis <- list(title = "Stress Level")
y_axis <- list(title = "Number of Students")

p1 <- plot_ly(stress_df, x = ~Stress_Level, y = ~Count, 
              type = "bar",
              marker = list(color = c('#FF6B6B', '#4ECDC4', '#45B7D1'))) %>%
  layout(title = "Distribution of Student Stress Levels",
         xaxis = x_axis, yaxis = y_axis)
p1
```

**Key Finding:** High stress is most prevalent (51.4% of students), followed by moderate stress (33.7%) and low stress (14.8%). This distribution suggests that academic pressure significantly affects the majority of students, with over half experiencing high stress levels. The relatively small proportion of low-stress students (14.8%) indicates that most students face considerable academic challenges.

## Categorical Analysis: Gender Distribution

```{r gender-analysis}
# Gender Distribution
gender_table <- table(data$Gender)
gender_df <- data.frame(
  Gender = names(gender_table), 
  Count = as.vector(gender_table)
)

p2 <- plot_ly(gender_df, labels = ~Gender, values = ~Count, 
              type = "pie",
              marker = list(colors = c('#FF9999', '#66B2FF'))) %>%
  layout(title = "Gender Distribution of Students")
p2
```

The gender distribution shows a balanced representation with approximately equal numbers of male and female students. This balanced sample ensures that any gender-related findings will have statistical validity and that lifestyle patterns can be generalized across both genders without sampling bias.

## Numerical Analysis: Grade Distribution

This section examines the distribution shape and statistical properties of student grades.

```{r grade-analysis, echo=TRUE}
# Grade statistics
grades <- data$Grades
mean_grade <- mean(grades)
median_grade <- median(grades)
sd_grade <- sd(grades)
skewness_grade <- (3 * (mean_grade - median_grade)) / sd_grade

# Interactive histogram
x_axis <- list(title = "Grade Point Average")
y_axis <- list(title = "Frequency")

p3 <- plot_ly(data, x = ~Grades, type = "histogram", 
              nbinsx = 25,
              marker = list(color = '#FFB347', opacity = 0.7)) %>%
  layout(title = "Student Grade Distribution",
         xaxis = x_axis, yaxis = y_axis)
p3

# Display statistics
cat("Grade Distribution Statistics:\n")
cat("Mean:", round(mean_grade, 3), "\n")
cat("Median:", round(median_grade, 3), "\n")
cat("Standard Deviation:", round(sd_grade, 3), "\n")
cat("Skewness:", round(skewness_grade, 3), "\n")
cat("Distribution Shape: Approximately symmetric\n")
```

**Distribution Analysis:** The grade distribution is approximately symmetric with mean = `r round(mean_grade, 2)` and median = `r round(median_grade, 2)`, indicating a normal distribution suitable for statistical analysis. The low skewness value (0.039) confirms symmetry, suggesting that most students cluster around the average performance with equal numbers of high and low performers. This normal distribution validates the use of parametric statistical tests for further analysis.

# Multi-Variable Analysis

## Study Hours vs Grades Relationship

This analysis examines the core relationship between study time and academic performance.

```{r study-grades, echo=TRUE}
# Calculate correlation
correlation <- cor(data$Study_Hours_Per_Day, data$Grades)

# Create scatter plot
x_axis <- list(title = "Study Hours Per Day")
y_axis <- list(title = "Grade Point Average")

p4 <- plot_ly(data, x = ~Study_Hours_Per_Day, y = ~Grades, 
              type = "scatter", mode = "markers",
              marker = list(color = ~Study_Hours_Per_Day, 
                          colorscale = 'Viridis', size = 5, opacity = 0.6)) %>%
  layout(title = "Study Hours vs Grades Relationship",
         xaxis = x_axis, yaxis = y_axis)
p4

cat("Correlation between Study Hours and Grades:", round(correlation, 3))
```

**Key Finding:** Strong positive correlation (r = `r round(correlation, 3)`) confirms that students who study more hours achieve higher grades. The scatter plot shows a clear linear relationship with minimal outliers, suggesting that study time is a reliable predictor of academic success. Students studying 8+ hours per day consistently achieve grades above 8.0, while those studying less than 6 hours rarely exceed 7.5.

## Grades by Stress Level Analysis

```{r stress-grades-boxplot}
# Box plot analysis
x_axis <- list(title = "Stress Level")
y_axis <- list(title = "Grade Point Average")

p5 <- plot_ly(data, x = ~Stress_Level, y = ~Grades, type = "box",
              color = ~Stress_Level,
              colors = c('#FF6B6B', '#4ECDC4', '#45B7D1')) %>%
  layout(title = "Grade Distribution by Stress Level",
         xaxis = x_axis, yaxis = y_axis,
         showlegend = FALSE)
p5
```

The box plot reveals that high-stress students tend to have higher median grades, suggesting that some academic pressure may be beneficial for performance. However, high-stress students also show greater variability in grades, indicating that while stress can motivate some students, it may negatively affect others. The moderate stress group shows the most consistent performance with fewer outliers.

## Mosaic Plot: Gender vs Stress Level

```{r mosaic-analysis, echo=TRUE}
# Gender vs Stress Level cross-tabulation
gender_stress_table <- table(data$Gender, data$Stress_Level)
print("Gender vs Stress Level Cross-tabulation:")
print(gender_stress_table)

# Create stacked bar chart
gender_stress_df <- as.data.frame(gender_stress_table)
names(gender_stress_df) <- c("Gender", "Stress_Level", "Count")

x_axis <- list(title = "Gender")
y_axis <- list(title = "Number of Students")

p6 <- plot_ly(gender_stress_df, x = ~Gender, y = ~Count, 
              color = ~Stress_Level, type = "bar",
              colors = c('#FF6B6B', '#4ECDC4', '#45B7D1')) %>%
  layout(title = "Gender vs Stress Level Distribution",
         xaxis = x_axis, yaxis = y_axis,
         barmode = 'stack')
p6
```

**Analysis:** The mosaic plot shows minimal gender differences in stress levels, indicating that stress patterns are similar across male and female students. Both genders show approximately 51% high stress, 33% moderate stress, and 15% low stress, suggesting that academic pressure affects students regardless of gender. This finding supports gender-neutral approaches to stress management and academic support services.

# Comprehensive Lifestyle Analysis

```{r comprehensive-analysis, echo=TRUE}
# Analyze all lifestyle factors by stress level
stress_analysis <- data %>%
  group_by(Stress_Level) %>%
  summarise(
    Count = n(),
    Avg_Study_Hours = round(mean(Study_Hours_Per_Day), 2),
    Avg_Sleep_Hours = round(mean(Sleep_Hours_Per_Day), 2),
    Avg_Physical_Activity = round(mean(Physical_Activity_Hours_Per_Day), 2),
    Avg_Social_Hours = round(mean(Social_Hours_Per_Day), 2),
    Avg_Grades = round(mean(Grades), 2),
    .groups = 'drop'
  )

print("Lifestyle Patterns by Stress Level:")
print(stress_analysis)

# Interactive comparison plot
stress_long <- stress_analysis %>%
  select(-Count) %>%
  pivot_longer(cols = -Stress_Level, names_to = "Variable", values_to = "Average_Value") %>%
  mutate(Variable = gsub("Avg_", "", Variable))

x_axis <- list(title = "Lifestyle Factors", tickangle = -45)
y_axis <- list(title = "Average Hours/Score")

p7 <- plot_ly(stress_long, x = ~Variable, y = ~Average_Value, 
              color = ~Stress_Level, type = "bar",
              colors = c('#FF6B6B', '#4ECDC4', '#45B7D1')) %>%
  layout(title = "Stress Level Comparison Across All Lifestyle Factors",
         xaxis = x_axis, yaxis = y_axis,
         barmode = 'group')
p7
```

**Critical Insight:** High-stress students study most (8.39 hrs) but sleep least (7.05 hrs), revealing a concerning trade-off between academic effort and rest. This pattern suggests that high-achieving students may be sacrificing essential sleep for study time, potentially impacting their long-term health and sustainability. Low-stress students maintain better sleep (8.06 hrs) but study significantly less (5.47 hrs), suggesting there might be a healthier balance somewhere in the middle where students can achieve good grades without exhausting themselves.
# Central Limit Theorem Demonstration

```{r clt-analysis, echo=TRUE}
# Demonstrate CLT using grade data
set.seed(123)
population <- data$Grades
sample_size <- 30
num_samples <- 1000

# Generate sample means
sample_means <- replicate(num_samples, mean(sample(population, sample_size, replace = TRUE)))

# Create histogram
x_axis <- list(title = "Sample Means")
y_axis <- list(title = "Frequency")

p8 <- plot_ly(x = ~sample_means, type = "histogram", 
              nbinsx = 30,
              marker = list(color = '#DDA0DD', opacity = 0.7)) %>%
  layout(title = "Distribution of Sample Means (Central Limit Theorem)",
         xaxis = x_axis, yaxis = y_axis)
p8

# Compare statistics
cat("Central Limit Theorem Results:\n")
cat("Population Mean:", round(mean(population), 3), "\n")
cat("Sample Means Mean:", round(mean(sample_means), 3), "\n")
cat("Population SD:", round(sd(population), 3), "\n")
cat("Sample Means SD:", round(sd(sample_means), 3), "\n")
cat("Theoretical SD:", round(sd(population)/sqrt(sample_size), 3), "\n")
```

**CLT Verification:** The distribution of sample means approaches normality, confirming the Central Limit Theorem with sample means distribution closely matching theoretical expectations. The sample means' standard deviation (0.132) is very close to the theoretical value (0.136), demonstrating that our sampling distribution follows the expected σ/√n formula. This validates the use of normal distribution assumptions for confidence intervals and hypothesis testing.

# Sampling Methods Comparison

```{r sampling-methods, echo=TRUE}
# Implement different sampling methods
set.seed(123)

# Simple random sampling
simple_sample <- sample_n(data, 200)

# Stratified sampling by gender
stratified_sample <- data %>%
  group_by(Gender) %>%
  sample_n(100) %>%
  ungroup()

# Compare results
sampling_results <- data.frame(
  Method = c("Population", "Simple Random", "Stratified (Gender)"),
  Sample_Size = c(nrow(data), nrow(simple_sample), nrow(stratified_sample)),
  Mean_Grade = round(c(mean(data$Grades), mean(simple_sample$Grades), 
                       mean(stratified_sample$Grades)), 3),
  SD_Grade = round(c(sd(data$Grades), sd(simple_sample$Grades),
                     sd(stratified_sample$Grades)), 3)
)

print("Sampling Methods Comparison:")
print(sampling_results)
```

**Sampling Conclusion:** All sampling methods produce estimates very close to population parameters, demonstrating their reliability for statistical inference. The maximum difference in mean grades across methods is only 0.073 points, well within acceptable margins of error. Stratified sampling by gender produces the most representative sample, while simple random sampling provides unbiased estimates with minimal computational complexity.

# Data Wrangling Analysis

```{r performance-analysis, echo=TRUE}
# Create performance categories
data <- data %>%
  mutate(Performance_Category = case_when(
    Grades >= quantile(Grades, 0.75) ~ "High Performer",
    Grades <= quantile(Grades, 0.25) ~ "Low Performer",
    TRUE ~ "Average Performer"
  ))

# Analyze lifestyle patterns by performance
performance_analysis <- data %>%
  group_by(Performance_Category) %>%
  summarise(
    Count = n(),
    Avg_Study_Hours = round(mean(Study_Hours_Per_Day), 2),
    Avg_Sleep_Hours = round(mean(Sleep_Hours_Per_Day), 2),
    Avg_Physical_Activity = round(mean(Physical_Activity_Hours_Per_Day), 2),
    Pct_High_Stress = round(100 * sum(Stress_Level == "High") / n(), 1),
    .groups = 'drop'
  )

print("Performance Category Analysis:")
print(performance_analysis)

# Visualization
x_axis <- list(title = "Performance Category")
y_axis <- list(title = "Average Hours")

p9 <- plot_ly(performance_analysis, x = ~Performance_Category, y = ~Avg_Study_Hours,
              type = "bar", name = "Study Hours", 
              marker = list(color = '#FF9999')) %>%
  add_trace(y = ~Avg_Sleep_Hours, name = "Sleep Hours", 
            marker = list(color = '#66B2FF')) %>%
  add_trace(y = ~Avg_Physical_Activity, name = "Physical Activity", 
            marker = list(color = '#98FB98')) %>%
  layout(title = "Lifestyle Patterns by Academic Performance",
         xaxis = x_axis, yaxis = y_axis,
         barmode = 'group')
p9
```

**Data Wrangling Insight:** The data shows students who get better grades study more hours each day. Top students study almost 9 hours daily while struggling students only study about 6 hours  that's nearly 3 extra hours of studying every single day. All students sleep about the same amount and do similar amounts of exercise. So the secret to better grades isn't about sleeping less or skipping the gym  it's just about spending more time studying.

# Correlation Analysis

```{r correlation-analysis, echo=TRUE}
# Correlation matrix for numerical variables
numerical_vars <- data %>%
  select(Study_Hours_Per_Day, Sleep_Hours_Per_Day, Physical_Activity_Hours_Per_Day, 
         Social_Hours_Per_Day, Grades)

cor_matrix <- cor(numerical_vars)
print("Correlation Matrix:")
print(round(cor_matrix, 3))

# Interactive correlation heatmap
p10 <- plot_ly(z = ~as.matrix(cor_matrix), type = "heatmap",
               x = colnames(cor_matrix), y = colnames(cor_matrix),
               colorscale = "RdBu", zmid = 0,
               text = round(cor_matrix, 3),
               texttemplate = "%{text}") %>%
  layout(title = "Correlation Matrix: Lifestyle Factors & Grades")
p10
```

**Correlation Findings:** Study hours show the strongest correlation with grades (r = 0.734), while sleep hours have a near-zero correlation with grades (r = -0.004), reflecting that sleep quantity alone doesn't determine academic performance. The strong negative correlation between study hours and physical activity (r = -0.488) suggests students trade exercise time for study time. Social activities show weak negative correlations with grades (r = -0.086), indicating minimal impact on academic performance.

# Conclusions

Based on this comprehensive analysis of lifestyle factors and student performance, several key findings emerge:

## Major Findings

1. **Study Hours Drive Performance:** Strong positive correlation (r = 0.919) between daily study hours and academic grades confirms that dedicated study time is the primary predictor of academic success.

2. **Stress-Performance Paradox:** High-stress students achieve the highest average grades (8.39) but sacrifice sleep (7.05 hours), suggesting that while some stress may motivate performance, it comes at a cost to well-being.

3. **Sleep-Study Trade-off:** The negative correlation between sleep and grades reflects students' tendency to sacrifice rest for study time, particularly among high performers.

4. **Gender Neutrality:** Minimal differences between male and female students across all lifestyle factors indicate that academic strategies should be gender-neutral.

5. **Performance Categories:** Clear lifestyle patterns distinguish high performers (more study hours) from low performers, providing actionable insights for academic improvement.

## Statistical Validation

- **Distribution Analysis:** Normal grade distribution validates parametric statistical methods
- **Central Limit Theorem:** Confirmed through sampling distribution analysis
- **Sampling Reliability:** Multiple sampling methods produce consistent population estimates

## Practical Implications

**For Students:** Balance study time with adequate sleep; aim for 7-9 study hours while maintaining 7-8 hours of sleep.

**For Educators:** Monitor high-achieving students for signs of sleep deprivation and stress-related issues.

**For Institutions:** Implement time management and stress reduction programs to help students achieve academic success while maintaining healthy lifestyles.

This analysis demonstrates that while academic performance is primarily driven by study effort, sustainable success requires balancing multiple lifestyle factors to maintain both high grades and student well-being.